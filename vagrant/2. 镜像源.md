# Vagrant 镜像配置指南

## 第二章：Vagrant 镜像源与配置

### 2.1 Vagrant 官方镜像源

1. **主要镜像平台**
   - Vagrant Cloud: `https://app.vagrantup.com/boxes/search`
   - HashiCorp Atlas: `https://atlas.hashicorp.com/boxes/search`

2. **官方镜像地址**
   - Ubuntu 镜像：
     ```
     https://vagrantcloud.com/ubuntu/boxes/focal64
     https://vagrantcloud.com/ubuntu/boxes/jammy64
     ```
   - CentOS 镜像：
     ```
     https://vagrantcloud.com/centos/boxes/7
     https://vagrantcloud.com/centos/boxes/8
     ```
   - Debian 镜像：
     ```
     https://vagrantcloud.com/debian/boxes/bullseye64
     https://vagrantcloud.com/debian/boxes/bookworm64
     ```

### 2.3 Box 操作指南

1. **添加 Box**
   - 从官方仓库添加（国内可能较慢）：
     ```powershell
     vagrant box add centos/7 --provider hyperv
     ```
   
   - 通过 URL 添加（可自定义名称）：
     ```powershell
     vagrant box add centos-7 http://mirrors.ustc.edu.cn/centos-cloud/centos/7/vagrant/x86_64/images/CentOS-7-x86_64-Vagrant-2004_01.VirtualBox.box
     ```
   
   - 添加本地 Box 文件：
     ```powershell
     vagrant box add centos_7 V:\vagrant_imgs\CentOS-7-x86_64-Vagrant-2004_01.VirtualBox.box
     ```

### 2.4 镜像配置方式

1. **全局配置**
   - 创建或编辑 `%USERPROFILE%\.vagrant.d\Vagrantfile`：
     ```ruby
     ENV['VAGRANT_SERVER_URL'] = 'https://vagrantcloud.com/'
     ```

2. **项目级配置**
   - 在项目的 `Vagrantfile` 中添加：
     ```ruby
     Vagrant.configure("2") do |config|
       config.vm.box = "ubuntu/focal64"
       config.vm.box_url = "https://vagrantcloud.com/ubuntu/boxes/focal64"
     end
     ```

### 2.5 镜像管理命令

1. **添加镜像**
   ```powershell
   vagrant box add ubuntu/focal64
   ```

2. **查看已安装的镜像**
   ```powershell
   vagrant box list
   ```

3. **更新镜像**
   ```powershell
   vagrant box update
   ```

4. **删除镜像**
   ```powershell
   vagrant box remove ubuntu/focal64
   ```

### 2.6 自定义镜像配置

1. **使用特定版本的镜像**
   ```ruby
   Vagrant.configure("2") do |config|
     config.vm.box = "ubuntu/focal64"
     config.vm.box_version = "202301.0.0"
   end
   ```

2. **配置镜像元数据**
   ```ruby
   Vagrant.configure("2") do |config|
     config.vm.box = "ubuntu/focal64"
     config.vm.box_version = "202301.0.0"
     config.vm.box_check_update = true
   end
   ```